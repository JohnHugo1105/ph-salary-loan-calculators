<header class="hero">
    <div class="hero-content">
        <h1>13th Month Pay Calculator</h1>
        <p class="subtitle">Quickly compute your pro-rated 13th-month pay and check for tax exemptions.</p>
    </div>
</header>

<section class="container">
    <div class="calc-layout">
        <!-- LEFT COLUMN: INPUTS -->
        <div class="input-col">
            <form [formGroup]="form">
                <mat-card class="input-card">
                    <mat-card-header>
                        <mat-card-title>Configuration</mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                        <div class="toggle-wrapper">
                            <mat-button-toggle-group formControlName="mode" appearance="standard">
                                <mat-button-toggle value="simple">Simple (Full Year)</mat-button-toggle>
                                <mat-button-toggle value="detailed">Pro-rated (Monthly)</mat-button-toggle>
                            </mat-button-toggle-group>
                        </div>

                        <p class="hint-text" *ngIf="form.value.mode === 'detailed'">
                            Enter your <strong>Basic Pay</strong> for each month you were employed. Leave 0 for months
                            unworked.
                        </p>

                        <div class="form-content">
                            <ng-container *ngIf="form.value.mode === 'simple'">
                                <mat-form-field appearance="outline">
                                    <mat-label>Current Monthly Basic Pay (₱)</mat-label>
                                    <input matInput type="text" appThousandsSeparator formControlName="monthlyBasic"
                                        inputmode="decimal" />
                                    <mat-hint>Assumes 12 months employment</mat-hint>
                                </mat-form-field>
                            </ng-container>

                            <ng-container *ngIf="form.value.mode === 'detailed'">
                                <div class="months-grid" formArrayName="history">
                                    <mat-form-field *ngFor="let month of months; let i = index" appearance="outline"
                                        class="density-sm">
                                        <mat-label>{{ month.slice(0, 3) }}</mat-label>
                                        <input matInput type="text" appThousandsSeparator [formControlName]="i"
                                            inputmode="decimal" />
                                    </mat-form-field>
                                </div>
                            </ng-container>
                        </div>
                    </mat-card-content>
                </mat-card>
            </form>
        </div>

        <!-- RIGHT COLUMN: RESULTS -->
        <div class="result-col">
            <mat-card class="result-card">
                <div class="result-label">Estimated 13th Month Pay</div>
                <div class="result-value">₱{{ result.gross13th | number:'1.2-2' }}</div>
            </mat-card>

            <mat-card class="detail-card">
                <mat-card-header>
                    <mat-card-title>Tax Analysis</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <div class="row">
                        <span>Tax-Exempt Portion</span>
                        <span class="num">₱{{ result.nonTaxable | number:'1.2-2' }}</span>
                    </div>

                    <div *ngIf="result.taxable > 0" class="taxable-section">
                        <div class="row warn">
                            <span>Taxable Excess (Over ₱90k)</span>
                            <span class="num">₱{{ result.taxable | number:'1.2-2' }}</span>
                        </div>

                        <div class="tax-estimator">
                            <div class="row small">
                                <span>Est. Tax Rate (%)</span>
                                <input type="number" [formControl]="$any(form).controls.taxRate" class="inline-input" />
                            </div>
                            <div class="row small">
                                <span>Est. Tax Due</span>
                                <span class="num warn">- ₱{{ result.taxDue | number:'1.2-2' }}</span>
                            </div>
                        </div>

                        <div class="row total">
                            <span>Net 13th Month Pay</span>
                            <span class="num primary">₱{{ result.net13th | number:'1.2-2' }}</span>
                        </div>
                    </div>

                    <div *ngIf="result.taxable === 0" class="row total">
                        <span class="success-text"><mat-icon inline>check_circle</mat-icon> Fully Tax-Exempt</span>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </div>

    <hr class="divider">

    <!-- SEO CONTENT -->
    <article class="content-article">
        <h2>How to Compute 13th Month Pay (Pro-rated)</h2>
        <p>
            According to Presidential Decree No. 851, every rank-and-file employee in the Philippines is entitled to
            13th-month pay,
            provided they have worked for at least one (1) month during the calendar year.
        </p>

        <h3>The Formula</h3>
        <p>
            The core formula is simple: <strong>Total Basic Salary Earned during the year ÷ 12</strong>.
        </p>
        <p>
            If you worked for the full year at a fixed rate, it simply equals one month's salary.
            However, if you had salary adjustments, leave without pay, or resigned mid-year, you must sum up the actual
            basic pay received
            for each month and divide the total by 12.
        </p>

        <h3>Is it Taxable? (The 90k Rule)</h3>
        <p>
            Under the TRAIN Law, the 13th-month pay and other benefits are <strong>tax-exempt up to ₱90,000</strong>.
            Any amount exceeding this cap is added to your taxable income and subject to withholding tax.
        </p>
    </article>
</section>