<header class="hero">
    <div class="hero-content">
        <h1>13th Month Pay Calculator</h1>
        <p class="subtitle">Quickly compute your pro-rated 13th-month pay and check for tax exemptions.</p>
    </div>
</header>

<section class="container">
    <div class="calc-layout">
        <!-- LEFT COLUMN: INPUTS -->
        <div class="input-col">
            <form [formGroup]="form">
                <mat-card class="input-card">
                    <mat-card-header>
                        <mat-card-title>Configuration</mat-card-title>
                    </mat-card-header>
                    <mat-card-content>
                        <div class="toggle-wrapper">
                            <mat-button-toggle-group formControlName="mode" appearance="standard">
                                <mat-button-toggle value="simple">Simple (Full Year)</mat-button-toggle>
                                <mat-button-toggle value="detailed">Pro-rated (Monthly)</mat-button-toggle>
                            </mat-button-toggle-group>
                        </div>

                        <p class="hint-text" *ngIf="form.value.mode === 'detailed'">
                            Enter your <strong>Basic Pay</strong> for each month you were employed. Leave 0 for months
                            unworked.
                        </p>

                        <div class="form-content">
                            <ng-container *ngIf="form.value.mode === 'simple'">
                                <mat-form-field appearance="outline">
                                    <mat-label>Current Monthly Basic Pay (₱)</mat-label>
                                    <input matInput type="text" appThousandsSeparator formControlName="monthlyBasic"
                                        inputmode="decimal" />
                                    <mat-hint>Assumes 12 months employment</mat-hint>
                                </mat-form-field>
                            </ng-container>

                            <ng-container *ngIf="form.value.mode === 'detailed'">
                                <div class="months-grid" formArrayName="history">
                                    <mat-form-field *ngFor="let month of months; let i = index" appearance="outline"
                                        class="density-sm">
                                        <mat-label>{{ month.slice(0, 3) }}</mat-label>
                                        <input matInput type="text" appThousandsSeparator [formControlName]="i"
                                            inputmode="decimal" />
                                    </mat-form-field>
                                </div>
                            </ng-container>
                        </div>
                    </mat-card-content>
                </mat-card>
            </form>
        </div>

        <!-- RIGHT COLUMN: RESULTS -->
        <div class="result-col">
            <mat-card class="result-card">
                <div class="result-label">Estimated 13th Month Pay</div>
                <div class="result-value">₱{{ result.gross13th | number:'1.2-2' }}</div>
            </mat-card>

            <mat-card class="detail-card">
                <mat-card-header>
                    <mat-card-title>Tax Analysis</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <div class="row">
                        <span>Tax-Exempt Portion</span>
                        <span class="num">₱{{ result.nonTaxable | number:'1.2-2' }}</span>
                    </div>

                    <div *ngIf="result.taxable > 0" class="taxable-section">
                        <div class="row warn">
                            <span>Taxable Excess (Over ₱90k)</span>
                            <span class="num">₱{{ result.taxable | number:'1.2-2' }}</span>
                        </div>

                        <div class="tax-estimator">
                            <div class="row small">
                                <span>Est. Tax Rate (%)</span>
                                <input type="number" [formControl]="$any(form).controls.taxRate" class="inline-input" />
                            </div>
                            <div class="row small">
                                <span>Est. Tax Due</span>
                                <span class="num warn">- ₱{{ result.taxDue | number:'1.2-2' }}</span>
                            </div>
                        </div>

                        <div class="row total">
                            <span>Net 13th Month Pay</span>
                            <span class="num primary">₱{{ result.net13th | number:'1.2-2' }}</span>
                        </div>
                    </div>

                    <div *ngIf="result.taxable === 0" class="row total">
                        <span class="success-text"><mat-icon inline>check_circle</mat-icon> Fully Tax-Exempt</span>
                    </div>
                </mat-card-content>
            </mat-card>
        </div>
    </div>

    <app-ad type="finmerkado"></app-ad>

    <hr class="divider">

    <!-- SEO CONTENT -->
    <article class="content-article">
        <h2>How to Compute 13th Month Pay (Pro-rated)</h2>
        <p>
            According to Presidential Decree No. 851, every rank-and-file employee in the Philippines is entitled to
            13th-month pay,
            provided they have worked for at least one (1) month during the calendar year.
            It must be paid no later than <strong>December 24</strong> of each year.
        </p>

        <h3>The Computation Formula</h3>
        <p>
            The core formula is simple: <strong>Total Basic Salary Earned during the year ÷ 12</strong>.
        </p>
        <p>
            This "Total Basic Salary" includes all remunerations or earnings paid by an employer for services rendered,
            but <strong>excludes</strong> allowances and monetary benefits which are not considered or integrated as
            part of the regular or basic salary, such as the cash equivalent of unused vacation and sick leave credits,
            overtime, premium, night differential and holiday pay, unless company practice or policy includes them.
        </p>
        <ul>
            <li><strong>Full Year Service:</strong> If you worked from Jan 1 to Dec 31 with no unpaid leave, it equals
                one month's basic salary.</li>
            <li><strong>Pro-Rated:</strong> If you started mid-year or had leave without pay, sum your actual basic pays
                and divide by 12.</li>
        </ul>

        <h3>Is it Taxable? (The 90k Rule)</h3>
        <p>
            Under the current tax laws (TRAIN Law), the 13th-month pay and other benefits are <strong>tax-exempt up to
                ₱90,000</strong>.
            This ₱90k cap applies to the <em>sum</em> of your 13th-month pay and other bonuses (like Christmas bonus,
            productivity incentives).
        </p>
        <p>
            <strong>What happens if it exceeds ₱90,000?</strong><br>
            Any amount in excess of ₱90,000 is added to your taxable income and will be subject to the graduating
            withholding
            tax rates.
        </p>

        <h3>Common Questions</h3>
        <div class="faq-item">
            <strong>Are resigned employees entitled to it?</strong>
            <p>Yes. Resigned or terminated employees must receive their pro-rated 13th-month pay. It is usually released
                together with their final pay (back pay).</p>
        </div>
        <div class="faq-item">
            <strong>Is it different from Christmas Bonus?</strong>
            <p>Yes. 13th-month pay is mandated by law. A Christmas bonus is voluntary and depends on the employer's
                discretion, though both share the same ₱90k tax exemption limit.</p>
        </div>
    </article>
</section>