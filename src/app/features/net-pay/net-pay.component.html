<section>
  <h1>Salary Net Pay</h1>

  <form [formGroup]="form" class="grid">
    <mat-form-field appearance="outline">
      <mat-label>Pay Frequency</mat-label>
      <mat-select formControlName="payFrequency">
        <mat-option value="monthly">Monthly</mat-option>
        <mat-option value="semi-monthly">Semi-monthly</mat-option>
      </mat-select>
    </mat-form-field>
    <mat-checkbox formControlName="includeHolidayPays">Include holiday pays</mat-checkbox>
    <mat-form-field appearance="outline">
      <mat-label>Monthly Basic (₱)</mat-label>
      <input matInput type="text" appThousandsSeparator formControlName="monthlyBasic" inputmode="decimal" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Allowances (₱)</mat-label>
      <input matInput type="number" formControlName="allowances" min="0" step="0.01" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Overtime Hours</mat-label>
      <input matInput type="number" formControlName="overtimeHours" min="0" step="0.01" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>OT Multiplier</mat-label>
      <input matInput type="number" formControlName="overtimeMultiplier" min="1" step="0.01" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Days/Month</mat-label>
      <input matInput type="number" formControlName="daysPerMonth" min="1" step="1" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Hours/Day</mat-label>
      <input matInput type="number" formControlName="hoursPerDay" min="1" step="1" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Months Worked (13th)</mat-label>
      <input matInput type="number" formControlName="monthsWorkedFor13th" min="0" max="12" step="1" />
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>13th-month tax rate (%)</mat-label>
      <input matInput type="number" formControlName="thirteenthTaxRatePct" min="0" max="50" step="0.5" />
    </mat-form-field>

    <mat-card class="card" style="grid-column: 1 / -1; padding: 12px;" *ngIf="form.value.includeHolidayPays">
      <h3>Holiday Days</h3>
      <div class="grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 8px;">
        <mat-form-field appearance="outline">
          <mat-label>Regular Holiday (unworked) days</mat-label>
          <input matInput type="number" formControlName="regHolUnworkedDays" min="0" step="1" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Regular Holiday (worked) days</mat-label>
          <input matInput type="number" formControlName="regHolWorkedDays" min="0" step="1" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Regular Holiday (rest day) days</mat-label>
          <input matInput type="number" formControlName="regHolRestWorkedDays" min="0" step="1" />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Special Holiday (unworked) days</mat-label>
          <input matInput type="number" formControlName="specHolUnworkedDays" min="0" step="1" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Special Holiday (worked) days</mat-label>
          <input matInput type="number" formControlName="specHolWorkedDays" min="0" step="1" />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Special Holiday (rest day) days</mat-label>
          <input matInput type="number" formControlName="specHolRestWorkedDays" min="0" step="1" />
        </mat-form-field>
      </div>
      <p class="note">Regular holiday: unworked=100% daily, worked=200%, rest day worked=260%. Special non-working: unworked=no pay, worked=130%, rest day worked=150%.</p>
    </mat-card>
  </form>

  <div class="cards" [@cardsIn]>
    <mat-card>
      <h3>Gross (Monthly)</h3>
      <div>Hourly rate: <span class="accent-number">₱{{ view.hourlyRate | number:'1.2-2' }}</span></div>
      <div>Daily wage: <span class="accent-number">₱{{ view.dailyWage | number:'1.2-2' }}</span></div>
      <div>Overtime pay: <span class="accent-number">₱{{ view.overtimePay | number:'1.2-2' }}</span></div>
      <div *ngIf="view.includeHolidayPays">Holiday pays (regular): <span class="accent-number">₱{{ view.holidayPays.regular.total | number:'1.2-2' }}</span></div>
      <div *ngIf="view.includeHolidayPays">Holiday pays (special): <span class="accent-number">₱{{ view.holidayPays.special.total | number:'1.2-2' }}</span></div>
      <div *ngIf="view.includeHolidayPays">Holiday pays (total): <span class="accent-number">₱{{ view.holidayPays.total | number:'1.2-2' }}</span></div>
      <div><strong>Total:</strong> <span class="accent-number">₱{{ view.grossMonthly | number:'1.2-2' }}</span></div>
    </mat-card>
    <mat-card>
      <h3>Contributions (Employee)</h3>
      <div>SSS: <span class="accent-number">₱{{ view.contributions.sss.employee | number:'1.2-2' }}</span></div>
      <div>PhilHealth: <span class="accent-number">₱{{ view.contributions.philhealth.employee | number:'1.2-2' }}</span></div>
      <div>Pag-IBIG: <span class="accent-number">₱{{ view.contributions.pagibig.employee | number:'1.2-2' }}</span></div>
      <div>MPF: <span class="accent-number">₱{{ view.contributions.mpf.employee | number:'1.2-2' }}</span></div>
      <div><strong>Total:</strong> <span class="accent-number">₱{{ view.contributions.totals.employee | number:'1.2-2' }}</span></div>
    </mat-card>
    <mat-card>
      <h3>Tax & Net</h3>
      <div>Gross ({{ view.payFrequency }}): <span class="accent-number">₱{{ view.grossPeriod | number:'1.2-2' }}</span></div>
      <div>Contrib ({{ view.payFrequency }}): <span class="accent-number">₱{{ view.contribPeriod | number:'1.2-2' }}</span></div>
      <div>Taxable ({{ view.payFrequency }}): <span class="accent-number">₱{{ view.taxablePeriod | number:'1.2-2' }}</span></div>
      <div>Withholding tax: <span class="accent-number">₱{{ view.tax | number:'1.2-2' }}</span></div>
      <div><strong>Net ({{ view.payFrequency }})</strong>: <span class="accent-number">₱{{ view.netPay | number:'1.2-2' }}</span></div>
    </mat-card>
    <mat-card>
      <h3>13th Month</h3>
      <div>Estimate: <span class="accent-number">₱{{ view.thirteenth | number:'1.2-2' }}</span></div>
      <div>Non-taxable: <span class="accent-number">₱{{ view.thirteenthSplit.nonTaxable | number:'1.2-2' }}</span></div>
      <div>Taxable: <span class="accent-number">₱{{ view.thirteenthSplit.taxable | number:'1.2-2' }}</span></div>
      <div>Assumed rate: <span class="accent-number">{{ view.thirteenthRate | number:'1.0-2' }}%</span></div>
      <div>Tax due (13th): <span class="accent-number">₱{{ view.thirteenthNet.taxDue | number:'1.2-2' }}</span></div>
      <div><strong>Net 13th-month:</strong> <span class="accent-number">₱{{ view.thirteenthNet.net | number:'1.2-2' }}</span></div>
    </mat-card>
  </div>

  <p class="note">Notes: This uses common PH defaults. Actual OT multipliers vary by day type. 13th month: first ₱90,000 is non-taxable; any excess is taxed. The entered 13th-month tax rate is applied to the taxable portion for a net estimate. For exact rates, apply the BIR withholding schedule applicable to bonuses.</p>
</section>
